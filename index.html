<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monogrid Generative</title>
  <style>
    @font-face {
      font-family: 'Geist Pixel';
      src: url('https://cdn.jsdelivr.net/npm/geist@1.7.0/dist/fonts/geist-pixel/GeistPixel-Square.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }
  </style>
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; overflow: hidden; background: #000; }
    #canvas { display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; image-rendering: pixelated; image-rendering: crisp-edges; }
    #ui {
      position: fixed; top: 16px; right: 16px; z-index: 10;
      font-family: 'Geist Pixel', monospace;
      font-size: 12px; color: #fff;
      display: flex; flex-direction: column; gap: 6px;
      background: rgba(0,0,0,0.7); padding: 14px; border-radius: 4px;
      user-select: none; min-width: 220px;
      backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px);
    }
    #ui .row { display: flex; align-items: center; gap: 8px; }
    #ui label { color: #888; text-transform: uppercase; font-size: 10px; letter-spacing: 0.5px; min-width: 56px; }
    #ui input[type=range] { flex: 1; accent-color: #fff; }
    #ui .val { color: #666; font-size: 10px; min-width: 28px; text-align: right; }
    #ui button {
      background: transparent; border: 1px solid #555; color: #fff;
      padding: 3px 8px; border-radius: 3px; cursor: pointer; font-family: 'Geist Pixel', monospace; font-size: 11px;
    }
    #ui input[type=color] {
      flex: 1; height: 22px; border: 1px solid #555; border-radius: 3px;
      background: transparent; cursor: pointer; padding: 0;
      -webkit-appearance: none; appearance: none;
    }
    #ui input[type=color]::-webkit-color-swatch-wrapper { padding: 1px; }
    #ui input[type=color]::-webkit-color-swatch { border: none; border-radius: 2px; }
    #ui select {
      flex: 1; background: #111; border: 1px solid #555; color: #fff;
      font-family: 'Geist Pixel', monospace; font-size: 10px;
      padding: 2px 4px; border-radius: 3px; cursor: pointer;
      -webkit-appearance: none; appearance: none;
    }
    #ui select:hover { border-color: #fff; }
    #frameControls { display: flex; flex-direction: column; gap: 6px; }
    #ui button:hover { border-color: #fff; }
    #ui button.active { border-color: #fff; background: rgba(255,255,255,0.1); }
    #ui .divider { border-top: 1px solid #333; margin: 2px 0; }
    #ui .hint { color: #555; font-size: 9px; margin-top: 2px; }

    /* ‚îÄ‚îÄ Frame mode ‚îÄ‚îÄ */
    #frame-text {
      display: none;
      position: absolute;
      z-index: 5;
      font-family: 'Geist Pixel', monospace;
      color: #2a2a2a;
    }
    #frame-title {
      font-size: var(--frame-title-size, 22px);
      letter-spacing: 0.5px;
      line-height: 1.3;
      outline: none;
      cursor: text;
    }
    #frame-sub {
      font-size: var(--frame-sub-size, 11px);
      line-height: 1.5;
      outline: none;
      cursor: text;
      margin-top: 6px;
      opacity: 0.65;
    }
    #frame-detail {
      font-size: var(--frame-detail-size, 9px);
      text-transform: uppercase;
      letter-spacing: 1px;
      outline: none;
      cursor: text;
      margin-top: 16px;
      opacity: 0.45;
    }
    body.framed { background: #e8ddd3; }
    body.framed #ui {
      background: rgba(0,0,0,0.55);
    }
    body.framed #frame-text { display: flex; flex-direction: column; }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <div id="frame-text">
    <div id="frame-title" contenteditable spellcheck="false">Title</div>
    <div id="frame-sub" contenteditable spellcheck="false">Subtitle</div>
    <div id="frame-detail" contenteditable spellcheck="false">DETAIL / INFO</div>
  </div>
  <div id="ui">
    <div class="row">
      <button id="prevSeed">‚óÄ</button>
      <button id="nextSeed">‚ñ∂</button>
      <button id="playPause">‚ùö‚ùö</button>
      <button id="regenerate">‚Üª</button>
    </div>

    <div class="divider"></div>

    <div class="row"><label>Res</label><input type="range" id="resolution" min="32" max="512" step="8" value="128"><span class="val" id="resVal">128</span></div>
    <div class="row"><label>Scale</label><input type="range" id="scale" min="0.1" max="6" step="0.1" value="1"><span class="val" id="scaleVal">1.0</span></div>
    <div class="row"><label>Subdiv</label><input type="range" id="subdivide" min="1" max="8" step="1" value="5"><span class="val" id="subdivVal">5</span></div>
    <div class="row"><label>Density</label><input type="range" id="density" min="0" max="1" step="0.05" value="0.5"><span class="val" id="densityVal">0.5</span></div>
    <div class="row"><label>Noise</label><input type="range" id="noise" min="0" max="1" step="0.05" value="0.5"><span class="val" id="noiseVal">0.5</span></div>
    <div class="row"><label>Warp</label><input type="range" id="warp" min="0" max="1" step="0.05" value="0"><span class="val" id="warpVal">0</span></div>
    <div class="row"><label>Lens</label><button id="lensToggle" class="active">ON</button></div>
    <div class="row"><label>Size</label><input type="range" id="lensSize" min="0.05" max="0.5" step="0.01" value="0.18"><span class="val" id="lensSizeVal">0.18</span></div>
    <div class="row"><label>Force</label><input type="range" id="lensForce" min="0.1" max="2" step="0.05" value="0.7"><span class="val" id="lensForceVal">0.7</span></div>

    <div class="divider"></div>

    <div class="row"><label>Speed</label><input type="range" id="speed" min="0.1" max="3" step="0.1" value="1"><span class="val" id="speedVal">1.0</span></div>
    <div class="row"><label>Period</label><input type="range" id="period" min="3" max="20" step="0.5" value="8"><span class="val" id="periodVal">8s</span></div>
    <div class="row"><label>Events</label><button id="eventsToggle" class="active">ON</button></div>
    <div class="row"><label>FG</label><input type="color" id="fgColor" value="#ffffff"></div>
    <div class="row"><label>BG</label><input type="color" id="bgColor" value="#000000"></div>
    <div class="row"><label>Frame</label><button id="frameToggle">OFF</button></div>
    <div id="frameControls" style="display:none;">
      <div class="row"><label>Frame BG</label><input type="color" id="frameBg" value="#000000"></div>
      <div class="row"><label>Ratio</label><select id="frameRatio">
        <option value="free">Free</option>
        <option value="1:1">1:1</option>
        <option value="4:5">4:5</option>
        <option value="4:3">4:3</option>
        <option value="3:2">3:2</option>
        <option value="16:9">16:9</option>
        <option value="5:4">5:4</option>
        <option value="3:4">3:4</option>
        <option value="2:3">2:3</option>
        <option value="9:16">9:16</option>
      </select></div>
      <div class="row"><label>Shape</label><select id="frameShape">
        <option value="rect">Rect</option>
        <option value="rounded">Rounded</option>
        <option value="circle">Circle</option>
        <option value="arch">Arch</option>
      </select></div>
      <div class="divider"></div>
      <div class="row"><label>Text</label><button id="textToggle" class="active">ON</button></div>
      <div class="row"><label>Txt Color</label><input type="color" id="textColor" value="#ffffff"></div>
      <div class="row"><label>Txt Size</label><input type="range" id="textSize" min="0.5" max="3" step="0.1" value="1"><span class="val" id="textSizeVal">1.0</span></div>
      <div class="row"><label>Position</label><select id="textPosition">
        <option value="tl">Top Left</option>
        <option value="bl">Bottom Left</option>
        <option value="tr">Top Right</option>
        <option value="br">Bottom Right</option>
      </select></div>
    </div>

    <div class="divider"></div>

    <div class="row">
      <button id="savePng">üíæ PNG</button>
      <button id="recordWebm">‚è∫ REC</button>
    </div>
    <div class="hint">Space: play/pause ¬∑ ‚Üê‚Üí: seed ¬∑ R: rand ¬∑ C: colors ¬∑ F: frame ¬∑ S: png</div>
  </div>
  <script type="module" src="/src/main.ts"></script>
</body>
</html>
