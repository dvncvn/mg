<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bitfield</title>
  <link rel="icon" type="image/png" href="/favicon.png">
  <meta name="description" content="Looping generative pixel art. Deterministic patterns from noise, dither, automata, and geometry. Interactive, seedable, infinite.">
  <meta name="theme-color" content="#000000">
  <meta property="og:title" content="bitfield">
  <meta property="og:description" content="Looping generative pixel art. Deterministic patterns from noise, dither, automata, and geometry.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="/og-image.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="/og-image.jpg">
  <style>
    @font-face {
      font-family: 'Geist Pixel';
      src: url('https://cdn.jsdelivr.net/npm/geist@1.7.0/dist/fonts/geist-pixel/GeistPixel-Square.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }
  </style>
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; overflow: hidden; background: #000; }
    #canvas { display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; image-rendering: pixelated; image-rendering: crisp-edges; transition: top 0.4s ease, left 0.4s ease, right 0.4s ease, width 0.4s ease, height 0.4s ease, border-radius 0.4s ease; }
    body.ui-open #canvas { width: calc(100% - 240px); }
    #ui {
      position: fixed; top: 0; right: 0; z-index: 10;
      display: none;
      font-family: 'Geist Pixel', monospace;
      font-size: 12px; color: #ccc;
      flex-direction: column; gap: 6px;
      background: #000; padding: 14px; border-radius: 0;
      border-left: 1px solid #1a1a1a;
      user-select: none; width: 240px;
      height: 100vh; height: 100dvh;
      overflow-y: auto;
    }
    #ui.open {
      display: flex;
    }
    #ui .row { display: flex; align-items: center; gap: 8px; }
    #ui label { color: #666; text-transform: uppercase; font-size: 10px; letter-spacing: 0.05em; min-width: 56px; }
    #ui input[type=range] { flex: 1; accent-color: #38ff7e; }
    #ui .val { color: #38ff7e; font-size: 10px; min-width: 28px; text-align: right; }
    #ui button {
      background: transparent; border: 1px solid #1a1a1a; color: #666;
      padding: 3px 8px; border-radius: 0; cursor: pointer; font-family: 'Geist Pixel', monospace; font-size: 11px;
    }
    #ui input[type=color] {
      flex: 1; height: 22px; border: 1px solid #1a1a1a; border-radius: 0;
      background: transparent; cursor: pointer; padding: 0;
      -webkit-appearance: none; appearance: none;
    }
    #ui input[type=color]::-webkit-color-swatch-wrapper { padding: 1px; }
    #ui input[type=color]::-webkit-color-swatch { border: none; border-radius: 0; }
    #ui select {
      flex: 1; background: rgba(0,0,0,0.5); border: 1px solid #1a1a1a; color: #ccc;
      font-family: 'Geist Pixel', monospace; font-size: 10px;
      padding: 2px 4px; border-radius: 0; cursor: pointer;
      -webkit-appearance: none; appearance: none;
    }
    #ui select:hover { border-color: #38ff7e; }
    #frameControls { display: flex; flex-direction: column; gap: 6px; }
    #bpmControls { display: flex; flex-direction: column; gap: 6px; }
    #textControls { display: flex; flex-direction: column; gap: 6px; }
    #autoControls { display: flex; flex-direction: column; gap: 6px; }
    #ui button:hover { border-color: #38ff7e; color: #ccc; }
    #ui button.active { border-color: #38ff7e; color: #38ff7e; background: rgba(56,255,126,0.05); }
    #ui .divider { border-top: 1px solid #1a1a1a; margin: 2px 0; }
    #ui .hint { color: #333; font-size: 9px; margin-top: 2px; }

    /* ‚îÄ‚îÄ Frame mode ‚îÄ‚îÄ */
    #frame-text {
      display: none;
      position: absolute;
      z-index: 5;
      font-family: 'Geist Pixel', monospace;
      color: #2a2a2a;
      user-select: none; -webkit-user-select: none;
    }
    #frame-title {
      font-size: var(--frame-title-size, 22px);
      letter-spacing: 0.5px;
      line-height: 1.3;
      outline: none;
      cursor: default;
    }
    #frame-title[contenteditable="true"] {
      user-select: text; -webkit-user-select: text;
      cursor: text;
    }
    #meta-ring {
      position: fixed;
      top: 10px; right: 10px;
      width: 100px; height: 100px;
      z-index: 6;
      pointer-events: none;
      animation: meta-spin 30s linear infinite;
    }
    #meta-ring svg text {
      font-family: 'Geist Pixel', monospace;
      font-size: 7px;
      fill: var(--meta-ring-color, #38ff7e);
      text-transform: uppercase;
      letter-spacing: 2px;
    }
    @keyframes meta-spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    #help-overlay {
      display: none;
      position: fixed; inset: 0; z-index: 100;
      background: rgba(0,0,0,0.92);
      backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
      align-items: center; justify-content: center;
      padding: 4vw;
    }
    #help-overlay.open { display: flex; }
    #help-inner {
      font-family: 'Geist Pixel', monospace;
      color: #fff;
      width: 100%; height: 100%;
      display: flex; align-items: center; justify-content: center;
    }
    .help-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 2px;
      width: 100%;
      overflow: hidden;
    }
    .help-cell {
      display: flex; flex-direction: column;
      justify-content: center;
      padding: 2.5vh 2vw;
      border: 1px solid #1a1a1a;
      overflow: hidden;
    }
    .help-key {
      color: #38ff7e;
      font-size: clamp(36px, 6vw, 80px);
      white-space: nowrap;
      margin-bottom: 0.2em;
    }
    .help-desc {
      color: #666;
      font-size: clamp(14px, 1.8vw, 26px);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    #boot-text {
      position: fixed; inset: 0; z-index: 50;
      display: flex; align-items: center; justify-content: center;
      font-family: 'Geist Pixel', monospace;
      color: #38ff7e;
      font-size: 7vw;
      letter-spacing: 0.02em;
      pointer-events: none;
      user-select: none; -webkit-user-select: none;
      transition: font-size 0.5s ease, color 0.5s ease;
    }
    #boot-text.hidden { display: none; }
    body.framed { background: #e8ddd3; }
    body.framed #ui {
      background: rgba(0,0,0,0.92);
    }
    body.framed #frame-text { display: flex; flex-direction: column; }
    #ui-toggle {
      position: fixed; top: 12px; right: 12px; z-index: 11;
      width: 32px; height: 32px;
      background: rgba(0,0,0,0.92); border: 1px solid #1a1a1a;
      border-radius: 0; color: #666; font-size: 16px;
      cursor: pointer; display: none; align-items: center; justify-content: center;
      font-family: 'Geist Pixel', monospace;
      backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
      transition: opacity 0.3s;
    }
    #ui-toggle:hover { border-color: #38ff7e; color: #38ff7e; }
    #ui-toggle.hidden { opacity: 0; pointer-events: none; }
    @media (pointer: coarse), (hover: none) {
      #ui-toggle { display: flex; }
      #ui-toggle.hidden { display: none; }
      #ui {
        font-size: 10px;
        width: 200px;
        padding: 10px;
      }
      body.ui-open #canvas { width: calc(100% - 200px); }
      #ui input[type="range"] { width: 80px; }
      #ui .row { gap: 5px; }
      #ui button, #ui select { font-size: 10px; }
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <div id="boot-text">bitfield</div>
  <button id="ui-toggle" title="Open controls">+</button>
  <div id="meta-ring">
    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <path id="meta-circle" d="M 50,50 m -40,0 a 40,40 0 1,1 80,0 a 40,40 0 1,1 -80,0" fill="none"/>
      </defs>
      <text>
        <textPath href="#meta-circle" id="meta-ring-text">SEED 000 ‚Ä¢ RES 184 ‚Ä¢ SCALE 4.6 ‚Ä¢ SUB 2 ‚Ä¢ BPM --- ‚Ä¢ SPEED 1.0 ‚Ä¢ </textPath>
      </text>
    </svg>
  </div>
  <div id="frame-text">
    <div id="frame-title" contenteditable spellcheck="false">Title</div>
  </div>
  <div id="ui">
    <button id="ui-close" style="align-self:flex-end; background:none; border:1px solid #1a1a1a; color:#666; font-size:11px; cursor:pointer; font-family:'Geist Pixel',monospace; padding:2px 6px;">‚úï</button>
    <div class="row">
      <button id="prevSeed">‚óÄ</button>
      <button id="nextSeed">‚ñ∂</button>
      <button id="playPause">‚ùö‚ùö</button>
      <button id="regenerate">‚Üª</button>
      <button id="autoAdvance" class="active">AUTO ‚óè</button>
    </div>
    <div id="autoControls">
      <div class="row"><label>Interval</label><input type="range" id="autoInterval" min="5" max="60" step="1" value="15"><span class="val" id="autoIntervalVal">15s</span></div>
      <div class="row"><label>Variance</label><input type="range" id="autoVariance" min="0" max="1" step="0.05" value="0.5"><span class="val" id="autoVarianceVal">0.5</span></div>
    </div>

    <div class="divider"></div>

    <div class="row"><label>Res</label><input type="range" id="resolution" min="32" max="512" step="8" value="184"><span class="val" id="resVal">184</span></div>
    <div class="row"><label>Scale</label><input type="range" id="scale" min="0.1" max="6" step="0.1" value="4.6"><span class="val" id="scaleVal">4.6</span></div>
    <div class="row"><label>Subdiv</label><input type="range" id="subdivide" min="1" max="8" step="1" value="2"><span class="val" id="subdivVal">2</span></div>
    <div class="row"><label>Density</label><input type="range" id="density" min="0" max="1" step="0.05" value="0.5"><span class="val" id="densityVal">0.5</span></div>
    <div class="row"><label>Noise</label><input type="range" id="noise" min="0" max="1" step="0.05" value="0.5"><span class="val" id="noiseVal">0.5</span></div>
    <div class="row"><label>Warp</label><input type="range" id="warp" min="0" max="1" step="0.05" value="0"><span class="val" id="warpVal">0</span></div>
    <div class="row"><label>Lens</label><button id="lensToggle" class="active">ON</button></div>
    <div class="row"><label>Size</label><input type="range" id="lensSize" min="0.05" max="0.5" step="0.01" value="0.18"><span class="val" id="lensSizeVal">0.18</span></div>
    <div class="row"><label>Force</label><input type="range" id="lensForce" min="0.1" max="2" step="0.05" value="0.7"><span class="val" id="lensForceVal">0.7</span></div>

    <div class="divider"></div>

    <div class="row"><label>Speed</label><input type="range" id="speed" min="0.1" max="3" step="0.1" value="1"><span class="val" id="speedVal">1.0</span></div>
    <div class="row"><label>Period</label><input type="range" id="period" min="1" max="64" step="0.5" value="8"><span class="val" id="periodVal">8s</span></div>
    <div class="row"><label>BPM</label><button id="bpmToggle">OFF</button></div>
    <div id="bpmControls" style="display:none;">
      <div class="row"><button id="tapTempo" style="flex:1">TAP</button><span class="val" id="bpmVal" style="min-width:50px;text-align:center;color:#fff">120</span></div>
      <div class="row"><label>Bars</label><select id="bpmBars">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="4" selected>4</option>
        <option value="8">8</option>
        <option value="16">16</option>
      </select></div>
    </div>
    <div class="row"><label>Events</label><button id="eventsToggle" class="active">ON</button></div>
    <div class="row"><label>FG</label><input type="color" id="fgColor" value="#ffffff"></div>
    <div class="row"><label>BG</label><input type="color" id="bgColor" value="#000000"></div>
    <div class="row"><label>Frame</label><button id="frameToggle">OFF</button></div>
    <div id="frameControls" style="display:none;">
      <div class="row"><label>Frame BG</label><input type="color" id="frameBg" value="#000000"><button id="frameBgLink" class="active" title="Link to grid BG">üîó</button></div>
      <div class="row"><label>Ratio</label><select id="frameRatio">
        <option value="free">Free</option>
        <option value="1:1">1:1</option>
        <option value="4:5">4:5</option>
        <option value="4:3">4:3</option>
        <option value="3:2">3:2</option>
        <option value="16:9">16:9</option>
        <option value="5:4">5:4</option>
        <option value="3:4">3:4</option>
        <option value="2:3">2:3</option>
        <option value="9:16">9:16</option>
      </select></div>
      <div class="row"><label>Shape</label><select id="frameShape">
        <option value="rect">Rect</option>
        <option value="rounded">Rounded</option>
        <option value="circle">Circle</option>
        <option value="arch">Arch</option>
      </select></div>
      <div class="row"><label>Layout</label><select id="frameLayout">
        <option value="center">Center</option>
        <option value="side">Side</option>
      </select></div>
    </div>

    <div class="divider"></div>

    <div class="row"><label>Text</label><button id="textToggle" class="active">ON</button></div>
    <div id="textControls" style="display:none;">
      <div class="row"><label>Gen</label><button id="genTextToggle" class="active">ON</button></div>
      <div class="row"><label>Txt Color</label><input type="color" id="textColor" value="#38ff7e"></div>
      <div class="row"><label>Txt Size</label><input type="range" id="textSize" min="0.5" max="12" step="0.1" value="9.3"><span class="val" id="textSizeVal">9.3</span></div>
      <div class="row"><label>Position</label><select id="textPosition">
        <option value="cc" selected>Center</option>
        <option value="cl">Center Left</option>
        <option value="bl">Bottom Left</option>
        <option value="tl">Top Left</option>
        <option value="br">Bottom Right</option>
        <option value="tr">Top Right</option>
      </select></div>
      <div class="row"><label>Case</label><select id="textCase">
        <option value="auto">Auto</option>
        <option value="lower">lowercase</option>
        <option value="upper">UPPERCASE</option>
        <option value="sentence">Sentence</option>
      </select></div>
    </div>

    <div class="divider"></div>

    <div class="row">
      <button id="savePng">üíæ PNG</button>
      <button id="recordWebm">‚è∫ REC</button>
    </div>
    <div class="hint">Space ¬∑ ‚Üê‚Üí seed ¬∑ ‚Üë‚Üì res ¬∑ [] subdiv ¬∑ +‚àí zoom ¬∑ 0 reset ¬∑ A auto ¬∑ R rand ¬∑ C colors ¬∑ T text ¬∑ F frame</div>
  </div>
  <div id="help-overlay">
    <div id="help-inner">
      <div class="help-grid">
        <div class="help-cell"><span class="help-key">Space</span><span class="help-desc">Play / Pause</span></div>
        <div class="help-cell"><span class="help-key">‚Üê ‚Üí</span><span class="help-desc">Prev / Next seed</span></div>
        <div class="help-cell"><span class="help-key">‚Üë ‚Üì</span><span class="help-desc">Resolution</span></div>
        <div class="help-cell"><span class="help-key">[ ]</span><span class="help-desc">Subdivision</span></div>
        <div class="help-cell"><span class="help-key">+ ‚àí</span><span class="help-desc">Zoom</span></div>
        <div class="help-cell"><span class="help-key">0</span><span class="help-desc">Reset zoom</span></div>
        <div class="help-cell"><span class="help-key">R</span><span class="help-desc">Randomize all</span></div>
        <div class="help-cell"><span class="help-key">C</span><span class="help-desc">Randomize colors</span></div>
        <div class="help-cell"><span class="help-key">T</span><span class="help-desc">Toggle text</span></div>
        <div class="help-cell"><span class="help-key">F</span><span class="help-desc">Cycle frame modes</span></div>
        <div class="help-cell"><span class="help-key">G</span><span class="help-desc">Exit frame</span></div>
        <div class="help-cell"><span class="help-key">A</span><span class="help-desc">Auto-advance</span></div>
        <div class="help-cell"><span class="help-key">S</span><span class="help-desc">Save PNG</span></div>
        <div class="help-cell"><span class="help-key">Cmd .</span><span class="help-desc">Controls</span></div>
        <div class="help-cell"><span class="help-key">?</span><span class="help-desc">This screen</span></div>
        <div class="help-cell"><span class="help-key">Esc</span><span class="help-desc">Close</span></div>
      </div>
    </div>
  </div>
  <script type="module" src="/src/main.ts"></script>
</body>
</html>
